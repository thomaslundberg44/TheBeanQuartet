<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Select date period</title>

<!-- Requires resources - Bootstrap, JQuery, and Moment.js -->

<link type="text/css" href="media/bootstrap-3.3.6-dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" media="all" href="media/css/daterangepicker.css" />
<script type="text/javascript" src="media/js/jquery.js"></script>
<script type="text/javascript" src="media/js/bootstrap.min.js"></script>
<script type="text/javascript" src="media/js/moment.min.js"></script>
<script type="text/javascript" src="media/js/daterangepicker.js"></script>

<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/style1.css">

</head>
<body class='indexPage'>
	<br>
	<br>
	<!--  <p>User story #8 - s a Support Engineer I want to count, for a
		given model of phone, the number of call failures it has had during a
		given time period.</p>  -->

	<div class="login-card">
	<form role="form" id="details">
		<div class="dropdown">
			<label>Select Phone Model:</label> 
			<br>
			<select class="form-control" id="model"></select>
		</div>
		<div>
			<label><i class="glyphicon glyphicon-calendar fa fa-calendar"></i> Enter Time Period:</label>
			<br>
			<input type="text" name="daterange" value="Click Here to select time period" class="form-control">
		</div>
		<input type="submit" class="login login-submit" value="Submit">
		</form>
		<a onclick="Help()" href="#">help</a>
	</div>
	

	<script type="text/javascript">
		var startDate;
		var endDate;
		
		$(function() {
			$('input[name="daterange"]').daterangepicker(
					{
						timePicker : true,
						timePickerIncrement : 1,
						locale : {
							format : 'DD/MM/YYYY h:mm A'
						}
					},
					function(start, end, label) {
						// alert("A new date range was chosen: " + start.format('YYYY-MM-DD  HH:mm') + ' to ' + end.format('YYYY-MM-DD HH:mm'));
					//	postDate(start.format('YYYY-MM-DD HH:mm'), end.format('YYYY-MM-DD HH:mm'));
						startDate = start.format('YYYY-MM-DD HH:mm');
						endDate = end.format('YYYY-MM-DD HH:mm');
			});
		});

		var $select = $('#model');

		//request the JSON data and parse into the select element
		$.ajax({
					async: false,
					url : 'http://localhost:8080/TheBeanQuartet/rest/basedata/modelType',
					dataType : 'JSON',
					success : function(data) {
						//clear the current content of the select
						$select.html('');
						//iterate over the data and append a select option
						$.each(data.baseDataCollection, function(i, val) {
							$select.append('<option>' + val + '</option>');
						})
					}
				});
		$("#details").submit(
			function postDate() {
				var obj1 = new obj(document.getElementById("model").value,startDate, endDate, "");
				alert(startDate);
				$.ajax({
					async : false,
					type : 'POST',
					url : 'rest/basedata/modelSearch',
					data : JSON.stringify(obj1),
					success : function message(data) {
						alert(JSON.stringify(data));
						//var count = data.baseDataCollection[0];
						//alert("Number of count = "+count);
					},
					contentType : 'application/json'
				});
			}
		);

		function obj(option1, option2, option3, option4) {
			this.option1 = option1;
			this.option2 = option2;
			this.option3 = option3;
			this.option4 = option4;
		}
		function Help(){
			alert(help);
		}
		var help="Enter a phone model and time period to count the number of call failures during that period";
	</script>


</body>
</html>